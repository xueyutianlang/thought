### 由QPS引发的思考

一个网站发展的技术瓶颈在哪里？

硬件、带宽、缓存、数据存储、分布式、架构还是业务逻辑？

#### 前提条件

> 蓝景商城（www.ljlj.cc）整个页面下载下来是42KByte大小   
> 机房带宽是10M独享   
> 1M带宽 ＝ 128KByte


   
	bit = byte/8   
	1Kbit = 1024bit = byte\*1024/8 = 128byte   
	1Mbit = 1024Kb = byte\*1024*1024/8 = 128Kbyte   
	2Mbit = 256Kbyte


#### DB因素

* 关系型数据库每次请求应该是0.01秒完成（平均的），也就是说100次／秒
* 每个页面一个DB请求，那QPS到100次／秒也就是极限了
* 这就该考虑缓存或者多DB负载

#### 带宽因素

* 如果带宽是10M独享的，也就是说同一秒的峰值最大是1280Kbyte
* 蓝景商城的首页所有的requests总计大小是42Kbyte,也就是1秒内请求首页最多30次，QPS=30次／秒

#### 内网带宽因素

* 按照蓝景商城的首页大小，1000QPS则需要330M带宽，实际测一下机房内网，是不是能达到该速度？？

#### memcache因素

* memcached理论悲观并发数是2万，默认安装的时候是1024
* 假设memcached的每次请求的数据大小是1KByte（内网）,2万并发的情况下，带宽需要156M左右

#### 线程模型因素

* 线程模型决定吞吐量（fork/select）
* 所有的数据都应该分布式处理


